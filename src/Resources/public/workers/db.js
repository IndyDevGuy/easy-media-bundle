!function(){"use strict";function e(e){return new Promise(((t,n)=>{e.oncomplete=e.onsuccess=()=>t(e.result),e.onabort=e.onerror=()=>n(e.error)}))}function t(t,n){const r=indexedDB.open(t);r.onupgradeneeded=()=>r.result.createObjectStore(n);const s=e(r);return(e,t)=>s.then((r=>t(r.transaction(n,e).objectStore(n))))}let n;function r(){return n||(n=t("keyval-store","keyval")),n}function s(t,n){return t("readonly",(t=>(t.openCursor().onsuccess=function(){this.result&&(n(this.result),this.result.continue())},e(t.transaction))))}var o=t("easy_media_manager","media_manager");onmessage=function(t){var n=t.data,a=n.type,c=n.key,u=n.val;switch(a){case"get":(function(t,n=r()){return n("readonly",(n=>e(n.get(t))))})(c,o).then((function(e){return postMessage(e)}));break;case"set":(function(t,n,s=r()){return s("readwrite",(r=>(r.put(n,t),e(r.transaction))))})(c,u,o).then((function(){return postMessage(!0)})).catch((function(){return postMessage(!1)}));break;case"del":(function(t,n=r()){return n("readwrite",(n=>(n.delete(t),e(n.transaction))))})(c,o).then((function(){return postMessage(!0)})).catch((function(){return postMessage(!1)}));break;case"clr":(function(t=r()){return t("readwrite",(t=>(t.clear(),e(t.transaction))))})(o).then((function(){return postMessage(!0)})).catch((function(){return postMessage(!1)}));break;case"keys":(function(e=r()){const t=[];return s(e,(e=>t.push(e.key))).then((()=>t))})(o).then((function(e){return postMessage(e)})).catch((function(){return postMessage(!1)}))}}}();